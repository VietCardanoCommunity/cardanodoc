<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cardano Viet Community</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>
<body>
  <header>
    <h1>Cardano Vietnam Community</h1>
    <nav>
      <a href="#home">Trang chủ</a>
      <a href="#wallet">Ví</a>
      <a href="#pool">Thông tin Pool</a>
    </nav>
  </header>

  <section id="wallet">
    <h2>Kết nối ví</h2>
    <div id="wallet-buttons" style="margin-bottom: 10px;"></div>
    <p>Địa chỉ ví: <span id="wallet-address"></span></p>
  </section>

  <section id="pool">
    <h2>Thông tin Pool</h2>
    <p>Pool Name: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_name"></span></p>
    <p>Pool ID: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_pool_id"></span> 
    (<span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_pool_id_hash"></span>)</p>
    <p>Live Stake: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_stake"></span> ADA</p>
    <p>Costs: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_tax_ratio"></span>% +  
      <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_tax_fix"></span> ADA</p>
    <p>Blocks in epoch: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_blocks_epoch"></span></p>
    <p>Blocks Lifetime: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_blocks_lifetime"></span></p>
    <p>Return (10 epochs): <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_roa_short"></span>%</p>
    <p>Return (lifetime): <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_roa_lifetime"></span>%</p>
    <p>Pledge: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_pledge"></span> ADA</p>
    <p>Delegators: <span id="pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_delegators"></span></p>
    <p>More info on <a href="https://cexplorer.io/pool/pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl">cexplorer.io</a></p>
  </section>

  <footer>
    <p>&copy; 2025 Cardano Vietnam Community. All rights reserved.</p>
  </footer>

  <script type="module">
    import { meshWallets, BrowserWallet } from "https://unpkg.com/@meshsdk/core@1.4.2?module";
    async function connectWallet(walletName) {
      const wallet = await BrowserWallet.enable(walletName);
      const address = await wallet.getChangeAddress();
      document.getElementById('wallet-address').innerText = address;
    }

    window.onload = async () => {
      const wallets = await BrowserWallet.getInstalledWallets();
      const container = document.getElementById("wallet-buttons");

      wallets.forEach((walletName) => {
        if (["nami", "eternl"].includes(walletName)) {
          const btn = document.createElement("button");
          btn.innerText = `Kết nối ${walletName}`;
          btn.onclick = () => connectWallet(walletName);
          container.appendChild(btn);
        }
      });
    };
  </script>

  <script>
    $.getJSON("https://js.cexplorer.io/api-static/pool/pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl.json", function(data) { 
      $.each(data.data, function(i, val) { 
        const fields = ['tax_fix', 'pledge', 'stake'];
        if (fields.includes(i)) val = Math.round(parseInt(val) / 1000000);
        if (i == 'blocks_lifetime') val = parseInt(val) + parseInt(data.data.blocks_epoch);
        $('#pool1tnymyv08dl3k9wyfz040vq626542ztm60wwyu7szwl5l6x9h3vl_' + i).html(val).text();   
      }); 
    });
  </script>
</body>
</html>
